<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RIMO â€” ì— ë²„ì„œë”</title>
<style>
  :root{
    --bg:#0b0b0f; --fg:#e8e8ef; --muted:#b9b9cc; --line:#23243a;
    --tile:#101223; --tileBd:#23243a;
    --accent:#7aa7ff;

    --tab-bg:#182039; --tab-bd:#2d3559; --tab-ink:#e6e8ef;
    --tab-pri:#26346d; --tab-pri-bd:#3b53a8;
  }

  *{box-sizing:border-box}
  body{
    margin:0; background:var(--bg); color:var(--fg);
    font-family:-apple-system,BlinkMacSystemFont,"Noto Sans KR",Roboto,Helvetica,Arial,sans-serif;
  }

  /* í—¤ë” (ë©”ì¸/í”„ë¡œí•„ê³¼ ë™ì¼) */
  header{
    position:sticky; top:0; z-index:5; background:rgba(11,11,15,.9);
    backdrop-filter:blur(8px); border-bottom:1px solid #232333;
  }
  .bar{display:flex; gap:10px; align-items:center; padding:14px 16px; height:56px}
  .logo{font-weight:900}
  .title{font-weight:800; opacity:.9}

  main{
    padding:16px; max-width:720px; margin:0 auto;
    display:flex; flex-direction:column; gap:12px;
    padding-bottom:100px; /* íƒ­ë°” ê²¹ì¹¨ ë°©ì§€ */
  }

  /* ì¹´ë“œ */
  .card{
    background:var(--tile);
    border:1px solid var(--tileBd);
    border-radius:16px;
    padding:10px 12px;
    display:flex; flex-direction:column; gap:7px;margin-bottom:10px;
  }
  .head{display:flex; gap:14px; align-items:center}
  .avatar{
    width:72px; height:72px; border-radius:50%;
    background:#1a1c2f; font-size:36px; display:flex; align-items:center; justify-content:center; flex:0 0 auto;
  }
  .idcol{min-width:0; flex:1}
  .nameRow{display:flex; align-items:center; gap:10px}
  .name{
    margin:0; font-size:16px; font-weight:800; line-height: 1.2;
    white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  }
  .intro{
    margin:4px 0 0;
    font-weight:600;
    font-size:13px;
    color:var(--fg);
  }
  .matchBtn{
    margin-left:auto;
    display:inline-flex; align-items:center; gap:6px;
    padding:6px 8px; border-radius:999px;
    background:#1a1c2f; border:0px solid #2b2e54; color:#e6e9ff;
    font-size:12px; font-weight:600; cursor:pointer;
    transition:box-shadow .15s ease, transform .15s ease, border-color .15s ease, background-color .15s ease;
  }
  .matchBtn.active{
    border-color:var(--accent);
    background:rgba(122,167,255,.16);
    box-shadow:0 0 12px rgba(122,167,255,.5), 0 0 0 2px rgba(122,167,255,.25) inset;
    transform:translateY(-1px);
  }
  .sub{margin:6px 0 0; color:var(--muted); font-size:13px}

  /* í•€ë²„íŠ¼(ìŠ¤íƒ€ì¼/í˜ì´ìŠ¤) â€” ì´ëª¨ì§€ ì œê±° + í•œ í–‰ ìµœëŒ€ 6ê°œ */
  .traits{
    display:grid;
    grid-template-columns:repeat(6, max-content);
    gap:6px;
    justify-content:flex-start;
  }
  .tag{
    display:inline-flex; align-items:center; justify-content:center;
    padding:6px 9px; border-radius:999px;
    background:#1a1c2f; border:0px solid #2b2e54;
    font-size:10px; font-weight:500; color:#e6e9ff;
    white-space:nowrap;
  }
  .tag.style.pill-urban   {background:#1e2d55;border-color:#2c4484}
  .tag.style.pill-curve   {background:#2a1f56;border-color:#40307a}
  .tag.style.pill-tour    {background:#1e3b3a;border-color:#2f5f5d}
  .tag.pace.pill-easy     {background:#1f3a1f;border-color:#2f5a2f}
  .tag.pace.pill-balanced {background:#3a341e;border-color:#5a4f2f}
  .tag.pace.pill-dynamic  {background:#3a1f1f;border-color:#5a2f2f}

  /* í•˜ë‹¨ ë„¤ë¹„ (ë©”ì¸/í”„ë¡œí•„ê³¼ ë™ì¼) */
  .tabbar{
    position:fixed; left:0; right:0; bottom:16px; z-index:2500;
    display:flex; gap:12px; justify-content:center;
  }
  .tabbar .tab{
    background:var(--tab-bg); border:1px solid var(--tab-bd); color:var(--tab-ink);
    padding:12px 18px; border-radius:22px; font-weight:800; text-decoration:none; font-size:14px;
  }
  .tabbar .tab.primary{background:var(--tab-pri); border-color:var(--tab-pri-bd)}
  
    /* ì½œ ì•„ì›ƒ */
  .callout{background:#101223;border:1px solid #23243a;border-radius:12px;
           padding:12px 14px;display:flex;gap:10px;align-items:center}
  .callout .cta{margin-left:auto;padding:8px 12px;border-radius:999px;
           background:#2a5bff;color:#fff;font-weight:800;border:0;cursor:pointer}
  .hidden{display:none}
</style>
</head>
<body>
<header>
  <div class="bar">
    <div class="logo">ğŸï¸ RIMO</div>
    <div class="title">ì— ë²„ì„œë”</div>
  </div>
</header>

<main>
  <section id="list" aria-label="ì— ë²„ì„œë” ëª©ë¡"></section>
</main>

<!-- í•˜ë‹¨ ë„¤ë¹„ -->
<nav class="tabbar" aria-label="í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜">
  <a href="index.html" class="tab">ë©”ì¸</a>
  <a href="rimo_profile.html" class="tab">í”„ë¡œí•„</a>
  <a href="rimo_ambassadors.html" class="tab primary">ì— ë²„ì„œë”</a>
</nav>

<script>
/* ===== ìƒìˆ˜ & ìŠ¤í† ë¦¬ì§€ í‚¤ ===== */
const ADMIN_DM = "http://pf.kakao.com/_ceUDn/chat";   // ì¹´ì¹´ì˜¤í†¡ ìš´ì˜ì DM
const LSK_PROFILE='rimo_profile_v1';
const LSK_MATCH='rimo_match_wish_v1';

/* ===== ìœ í‹¸ ===== */
function loadProfile(){
  try{ return JSON.parse(localStorage.getItem(LSK_PROFILE)||'{}'); }
  catch(e){ return {}; }
}
function loadMatchWish(){
  try{ return new Set(JSON.parse(localStorage.getItem(LSK_MATCH)||'[]')); }
  catch(e){ return new Set(); }
}
function saveMatchWish(set){
  localStorage.setItem(LSK_MATCH, JSON.stringify(Array.from(set)));
}
async function copyText(txt){
  try{
    await navigator.clipboard.writeText(txt);
    return true;
  }catch(e){
    const ta=document.createElement('textarea'); ta.value=txt; document.body.appendChild(ta);
    ta.select(); document.execCommand('copy'); ta.remove();
    return true;
  }
}

/* ===== ë©”íƒ€(ë¼ë²¨ë§Œ ì‚¬ìš©) ===== */
const STYLE_META = {
  Urban:{cls:'pill-urban',  label:'Urban'},
  Curve:{cls:'pill-curve',  label:'Curve'},
  Tour: {cls:'pill-tour',   label:'Tour'},
};
const PACE_META = {
  Easy:    {cls:'pill-easy',     label:'Easy'},
  Balanced:{cls:'pill-balanced', label:'Balanced'},
  Dynamic: {cls:'pill-dynamic',  label:'Dynamic'},
};

/* ===== ë”ë¯¸ ë°ì´í„° ===== */
const demo = [
  { id:'a2', icon:'ğŸ›µ', name:'Mira',  region:'ì„œìš¸ ì„±ë™êµ¬', bike:'Vespa Primavera', styles:['Urban'], pace:['Easy'],  intro:'ì„±ìˆ˜Â·ê°•ë‚¨ ì¹´í˜íˆ¬ì–´ ì¢‹ì•„ìš”' },
  { id:'a3', icon:'ğŸï¸', name:'Owen',  region:'ì„œìš¸ ë§ˆí¬êµ¬', bike:'Yamaha MT-07',   styles:['Curve','Tour'], pace:['Balanced'], intro:'ê°€ì–‘ëŒ€êµ~ë¶ì•… íŒ”ê°ì • ì¦ê²¨ìš”' },
  { id:'a4', icon:'ğŸ¶', name:'Nabi',  region:'ì„œìš¸ ì†¡íŒŒêµ¬', bike:'Honda Grom',      styles:['Urban'], pace:['Dynamic'], intro:'ì‹¬ì•¼ í•œê°• ìˆœí™˜ ë°¤ë°”ë¦¬ëŸ¬!' },
];

/* ===== ë§¤ì¹­ í…ìŠ¤íŠ¸ êµ¬ì„± ===== */
function composeMatchText(target, me){
  const styles = (me.styles||[]).join(' Â· ') || '-';
  const pace   = (me.pace||[]).join(' Â· ')   || '-';
  const intro  = me.intro ? `"${me.intro.slice(0,25)}"` : '-';
  return (
`[ğŸ¤ ë§¤ì¹­ í¬ë§]
ëŒ€ìƒ: ${target.name}${target.region? ' Â· '+target.region:''}${target.bike? ' / '+target.bike:''}

[ë‚´ í”„ë¡œí•„]
ğŸ‘¤ ë¼ì´ë”: ${me.name||'ë¯¸ì…ë ¥'} ${me.icon||''}
ğŸ“ ì§€ì—­: ${me.region||'-'}
ğŸï¸ ê¸°ì¢…: ${me.bike||'-'}
â° ì‹œê°„ëŒ€: ${me.time||'-'}
ğŸ‘¥ íƒ ë¤: ${me.tandem||'-'}

ğŸ¯ ìŠ¤íƒ€ì¼: ${styles}
âš¡ í˜ì´ìŠ¤: ${pace}
ğŸ“ ì†Œê°œ: ${intro}`
  );
}

/* ===== ëª©ë¡ êµ¬ì„± ===== */
function buildAmbassadors(){
  const me = loadProfile();
  const list = [];
  if (me && me.name){
    list.push({
      id:'me', icon: me.icon || 'ğŸï¸',
      name: me.name + ' (ë‚˜)',
      region: me.region || '',
      bike: me.bike || 'ë°”ì´í¬ ë¯¸ì…ë ¥',
      styles: Array.isArray(me.styles) ? me.styles : [],
      pace: Array.isArray(me.pace) ? me.pace : [],
      intro: (me.intro || '').slice(0,25)
    });
  }
  return list.concat(demo);
}

/* ===== ë Œë” ===== */
const listEl = document.getElementById('list');

function tagEl(cls, text){
  const div = document.createElement('div');
  div.className = 'tag ' + cls;
  div.textContent = text;
  return div;
}

function render(){
  const wishes = loadMatchWish();
  const ambs = buildAmbassadors();
  listEl.innerHTML = '';
  ambs.forEach(a=>{
    const card = document.createElement('article');
    card.className = 'card';

    const head = document.createElement('div');
    head.className = 'head';

    const avatar = document.createElement('div');
    avatar.className = 'avatar';
    avatar.textContent = a.icon || 'ğŸï¸';

    const idcol = document.createElement('div');
    idcol.className = 'idcol';

    const nameRow = document.createElement('div');
    nameRow.className = 'nameRow';

    const name = document.createElement('h3');
    name.className = 'name';
    name.textContent = a.name || 'ë¼ì´ë”';

    /* ë‚´ í”„ë¡œí•„: ë§¤ì¹­í¬ë§ â†’ í”„ë¡œí•„ ìˆ˜ì • */
    if(a.id === 'me'){
      const editBtn = document.createElement('button');
      editBtn.type = 'button';
      editBtn.className = 'matchBtn';
      editBtn.textContent = 'í”„ë¡œí•„ ìˆ˜ì •';
      editBtn.addEventListener('click', ()=>{ location.href = 'rimo_profile.html'; });
      nameRow.appendChild(name);
      nameRow.appendChild(editBtn);
    } else {
      const matchBtn = document.createElement('button');
      matchBtn.type = 'button';
      matchBtn.className = 'matchBtn';
      const wished = wishes.has(a.id);
      if(wished) matchBtn.classList.add('active');
      matchBtn.innerHTML = `${wished?'âœ…':'ğŸ¤'} ë§¤ì¹­í¬ë§`;
      matchBtn.addEventListener('click', async ()=>{
        /* 1) ë‚´ í”„ë¡œí•„ í™•ì¸ */
        const me = loadProfile();
        if(!me || !me.name){
          if(confirm('ë¨¼ì € í”„ë¡œí•„ì„ ì‘ì„±í•´ ì£¼ì„¸ìš”. ì§€ê¸ˆ í”„ë¡œí•„ í˜ì´ì§€ë¡œ ì´ë™í• ê¹Œìš”?')){
            location.href = 'rimo_profile.html';
          }
          return;
        }
        /* 2) ë§¤ì¹­ í¬ë§ í† ê¸€ ì €ì¥ */
        if(wishes.has(a.id)){ wishes.delete(a.id); }
        else { wishes.add(a.id); }
        saveMatchWish(wishes);
        matchBtn.classList.toggle('active');
        matchBtn.innerHTML = `${wishes.has(a.id)?'âœ…':'ğŸ¤'} ë§¤ì¹­í¬ë§`;

        /* 3) ìš´ì˜ìì—ê²Œ ë³´ë‚¼ í…ìŠ¤íŠ¸ êµ¬ì„± + í´ë¦½ë³´ë“œ ë³µì‚¬ + ì¹´ì¹´ì˜¤í†¡ ì—´ê¸° */
        const msg = composeMatchText(a, me);
        await copyText(msg);
        alert('ë§¤ì¹­ ìš”ì²­ ë‚´ìš©ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì¹´ì¹´ì˜¤í†¡ 1:1 ì±„íŒ…ì´ ì—´ë¦½ë‹ˆë‹¤. ë¶™ì—¬ë„£ê¸° í•´ ì£¼ì„¸ìš”.');
        location.href = ADMIN_DM;
      });
      nameRow.appendChild(name);
      nameRow.appendChild(matchBtn);
    }

    idcol.appendChild(nameRow);

    /* ìê¸°ì†Œê°œ(ë”°ì˜´í‘œ) */
    if (a.intro){
      const intro = document.createElement('p');
      intro.className = 'intro';
      intro.textContent = `"${(a.intro || '').slice(0,25)}"`;
      idcol.appendChild(intro);
    }

    const sub = document.createElement('p');
    sub.className = 'sub';
    sub.textContent = `${a.region? a.region+' Â· ' : ''}${a.bike || ''}`;
    idcol.appendChild(sub);

    head.appendChild(avatar);
    head.appendChild(idcol);

    /* ìŠ¤íƒ€ì¼/í˜ì´ìŠ¤ íƒœê·¸ (ë‹¨ì–´ë§Œ) */
    const traits = document.createElement('div');
    traits.className = 'traits';
    const styles = (a.styles && a.styles.length) ? a.styles : [];
    const pace   = (a.pace && a.pace.length) ? a.pace : [];
    const all    = [...styles.map(s => ({type:'style', key:s})), ...pace.map(p => ({type:'pace', key:p}))];

    if(all.length === 0){
      traits.appendChild(tagEl('style', '-'));
    }else{
      all.forEach(item=>{
        if(item.type==='style' && STYLE_META[item.key]){
          const m = STYLE_META[item.key];
          traits.appendChild(tagEl(`style ${m.cls}`, m.label));
        }else if(item.type==='pace' && PACE_META[item.key]){
          const m = PACE_META[item.key];
          traits.appendChild(tagEl(`pace ${m.cls}`, m.label));
        }else{
          traits.appendChild(tagEl(item.type, item.key));
        }
      });
    }

    card.appendChild(head);
    card.appendChild(traits);
    listEl.appendChild(card);
  });
}

render();
</script>
</body>
</html>
