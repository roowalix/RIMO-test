<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RIMO — 어드민 · 크루 생성</title>
<style>
  :root{
    --bg:#0b0b0f; --fg:#e8e8ef; --muted:#b9b9cc; --line:#232333;
    --tile:#141627; --tile2:#101223; --accent:#7aa7ff; --good:#2aa84a; --bad:#ff5d5d;
    --chip-bg:#14172a; --chip-bd:#2b2e54; --accent-glow: rgba(122,167,255,.35);

    /* Theme Colors */
    --t-red:#ff5d5d;      --t-red-bg:rgba(255,93,93,.14);      --t-red-br:rgba(255,93,93,.35);
    --t-blue:#7aa7ff;     --t-blue-bg:rgba(122,167,255,.14);   --t-blue-br:rgba(122,167,255,.35);
    --t-yellow:#ffd85d;   --t-yellow-bg:rgba(255,216,93,.16);  --t-yellow-br:rgba(255,216,93,.38);
    --t-green:#56d364;    --t-green-bg:rgba(86,211,100,.16);   --t-green-br:rgba(86,211,100,.42);
    --t-purple:#a78bfa;   --t-purple-bg:rgba(167,139,250,.16); --t-purple-br:rgba(167,139,250,.42);
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--fg);font-family:-apple-system,BlinkMacSystemFont,"Noto Sans KR",Roboto,Arial,sans-serif}

  /* 헤더 */
  header{position:sticky;top:0;z-index:5;background:rgba(11,11,15,.9);backdrop-filter:blur(8px);border-bottom:1px solid var(--line)}
  .bar{display:flex;gap:10px;align-items:center;justify-content:space-between;padding:12px 16px}
  .title{font-weight:900;font-size:16px}
  .home-btn{width:36px;height:36px;display:flex;align-items:center;justify-content:center;font-size:30px;border-radius:8px;border:none;background:transparent;cursor:pointer;transition:background .2s}
  .home-btn:hover{background:rgba(255,255,255,.08)}

  /* 본문 레이아웃 */
  main{padding:16px;display:grid;gap:16px;max-width:980px;margin:0 auto;padding-bottom:120px}
  .panel{background:var(--tile);border:1px solid var(--line);border-radius:14px;padding:14px}

  /* 절대값 변수 (원하는 값으로 조정 가능) */
:root{
  --label-w: 56px;      /* 데스크톱 라벨 폭: 한글 2~3글자 기준 */
  --label-gap: 8px;     /* 라벨과 폼 사이 고정 간격 */

  --label-w-sm: 44px;   /* 모바일 라벨 폭 */
  --label-gap-sm: 6px;  /* 모바일 라벨-폼 간격 */
}

/* 라벨 열 = 고정폭(px), 내용 열 = 남는 영역 전부 */
.row{
  display:grid;
  grid-template-columns: var(--label-w) 1fr;
  gap: var(--label-gap);
  align-items:center;
  margin:10px 0;
}

/* 라벨을 좌측 정렬, 딱 붙게 */
.row > label{
  font-weight:700;
  color:#cfd1e8;
  font-size:14px;
  justify-self:start;
  text-align:left;
  white-space:nowrap;           /* 혹시 모를 줄바꿈 방지 */
}

/* 내용 영역이 제대로 ‘줄어들 수’ 있게 */
.field{ min-width:0; }          /* grid에서는 이게 중요합니다 */
.field > *{ width:100%; }       /* input/select/textarea가 꽉 차도록 */

/* 모바일에서 라벨/간격만 더 타이트하게 */
@media (max-width:560px){
  .row{
    grid-template-columns: var(--label-w-sm) 1fr;
    gap: var(--label-gap-sm);
}


  /* 입력 공통 + 포커스 글로우 */
  input,select,textarea{
    width:100%;padding:10px 12px;border-radius:10px;border:1px solid #2c2f48;background:#0f1020;color:#fff;font-size:14px;
    transition: border-color .15s ease, box-shadow .15s ease;
  }
  input:focus, select:focus, textarea:focus{
    outline:none;
    border-color: var(--accent);
    box-shadow: 0 0 0 2px var(--accent-glow), 0 0 0 1px var(--accent) inset;
  }
  /* 포커스된 행 라벨 미세 강조(지원 브라우저에서만) */
  .row:has(input:focus), .row:has(select:focus), .row:has(textarea:focus) > label{ color:#eef3ff; }

  .two{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .coords{display:grid;grid-template-columns:1fr 1fr;gap:10px} /* 좌표/인원: 2열 고정 */

  /* === 토글(rimo_profile 스타일) ========================= */
  .toggles{display:flex;gap:10px;flex-wrap:wrap;margin:0}
  .toggle{
    display:inline-flex;align-items:center;gap:14px;padding:8px 12px;border-radius:999px;
    color:#e6e9ff;font-size:13px;cursor:pointer;user-select:none;white-space:nowrap;
    transition:transform .15s ease, box-shadow .15s ease;
    background:var(--chip-bg); border:1px solid var(--chip-bd);
  }
  .toggle.active{
    border-color:var(--accent); background:rgba(122,167,255,.16);
    box-shadow:0 0 10px var(--accent-glow); transform:translateY(-1px) scale(1.01);
    font-weight:500;
  }

  /* === 테마 필버튼: 네비 스타일 ========================== */
  .themes{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  .theme-btn{
    display:grid;grid-template-columns:auto 1fr;align-items:center;
    gap:4px;padding:4px 8px;border-radius:16px;border:1px solid #2b2e48;background:#14172a;color:#e8e8ef;
    font-size:12px;font-weight:500;letter-spacing:0;cursor:pointer;user-select:none;
    flex:0 0 auto; white-space:nowrap;
    transition:transform .12s ease, box-shadow .12s ease, background .12s ease, border-color .12s ease, color .12s ease;
  }
  .theme-btn .badge{
    width:14px;height:14px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:12px;background:#0f1020;border:0;
  }
  .theme-btn.active{
    transform:translateY(-1px) scale(1.02);
    box-shadow:0 0 0 1px currentColor inset, 0 0 12px currentColor;
    background:transparent;
  }
  /* 각 테마 색상(버튼 전체/배지) */
  .theme-btn[data-theme="red"]    { color:var(--t-red);    background:var(--t-red-bg);    border-color:var(--t-red-br) }
  .theme-btn[data-theme="red"] .badge    { background:rgba(255,93,93,.12);  border-color:var(--t-red-br) }
  .theme-btn[data-theme="blue"]   { color:var(--t-blue);   background:var(--t-blue-bg);   border-color:var(--t-blue-br) }
  .theme-btn[data-theme="blue"] .badge   { background:rgba(122,167,255,.12);border-color:var(--t-blue-br) }
  .theme-btn[data-theme="yellow"] { color:var(--t-yellow); background:var(--t-yellow-bg); border-color:var(--t-yellow-br) }
  .theme-btn[data-theme="yellow"] .badge { background:rgba(255,216,93,.12); border-color:var(--t-yellow-br) }
  .theme-btn[data-theme="green"]  { color:var(--t-green);  background:var(--t-green-bg);  border-color:var(--t-green-br) }
  .theme-btn[data-theme="green"] .badge  { background:rgba(86,211,100,.12); border-color:var(--t-green-br) }
  .theme-btn[data-theme="purple"] { color:var(--t-purple); background:var(--t-purple-bg); border-color:var(--t-purple-br) }
  .theme-btn[data-theme="purple"] .badge { background:rgba(167,139,250,.12);border-color:var(--t-purple-br) }

  /* 기능버튼 */
  .btn{padding:10px 14px;border-radius:10px;border:1px solid #2b2e48;background:#1b1d2e;color:#fff;cursor:pointer}
  .btn.small{padding:8px 10px;font-size:12px}
  .btn.primary{background:#2a5bff;border-color:#3d6aff}
  .btnbar{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;justify-content:center;}

  /* 카드 */
  .cards{display:grid;gap:10px;margin-top:10px}
  .card{background:#141628;border:1px solid var(--line);border-radius:12px;padding:12px}
  .card .tt{font-weight:800}
  .card .sub{color:#c8cae0;font-size:12px;margin-top:4px}

  /* 카드: 테마별 악센트 & 라우트 */
  .card .theme-tag{
    display:inline-flex;align-items:center;gap:6px;
    padding:4px 8px;border-radius:999px;font-size:11px;font-weight:800;
    border:1px solid currentColor;background:transparent;margin-right:6px;
  }
  .route{display:flex;align-items:center;gap:8px;margin-top:6px;color:inherit}
  .pin{width:8px;height:8px;border-radius:999px;background:currentColor}
  .dash{flex:1;border-top:1px dashed currentColor;opacity:.7}

  /* 카드 색 적용 */
  .card[data-theme="red"]    { border-color:var(--t-red-br) }
  .card[data-theme="blue"]   { border-color:var(--t-blue-br) }
  .card[data-theme="yellow"] { border-color:var(--t-yellow-br) }
  .card[data-theme="green"]  { border-color:var(--t-green-br) }
  .card[data-theme="purple"] { border-color:var(--t-purple-br) }

  .card[data-theme="red"]    .theme-tag,.card[data-theme="red"]    .route{ color:var(--t-red) }
  .card[data-theme="blue"]   .theme-tag,.card[data-theme="blue"]   .route{ color:var(--t-blue) }
  .card[data-theme="yellow"] .theme-tag,.card[data-theme="yellow"] .route{ color:var(--t-yellow) }
  .card[data-theme="green"]  .theme-tag,.card[data-theme="green"]  .route{ color:var(--t-green) }
  .card[data-theme="purple"] .theme-tag,.card[data-theme="purple"] .route{ color:var(--t-purple) }

  /* 하단 네비 */
  .btmnav{position:fixed;left:0;right:0;bottom:0;z-index:10;background:rgba(11,11,15,.9);backdrop-filter:blur(10px);border-top:1px solid var(--line)}
  .btmnav .wrap{max-width:980px;margin:0 auto;display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:10px;padding:8px}
  .navitem{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px;padding:8px 4px;border-radius:10px;border:1px solid #2b2e48;background:#14172a;cursor:pointer;font-size:12px;text-align:center;user-select:none;transition:background .2s,transform .1s;text-decoration:none;color:var(--fg)}
  .navitem.active{background:#27306a;border-color:#3a4aa2}
  .navitem .ico{font-size:18px;line-height:1}
  .navitem:active{transform:translateY(1px)}
</style>
</head>
<body>
<header>
  <div class="bar">
    <div class="title">🏍️ RIMO — 어드민 · 크루 생성</div>
    <button class="home-btn" id="goMain" title="메인 이동">🏠</button>
  </div>
</header>

<main>
  <section class="panel">

    <!-- 제목 -->
    <div class="row">
      <label for="c_title">제목</label>
      <div class="field">
        <input id="c_title" placeholder="예: &lt;가을맞이 카페 라이딩&gt;">
      </div>
    </div>

    <!-- 일시 -->
    <div class="row">
      <label for="c_datetime">일시</label>
      <div class="field">
        <input id="c_datetime" type="datetime-local" step="1800">
      </div>
    </div>

    <!-- 출발 -->
    <div class="row">
      <label for="c_from">출발</label>
      <div class="field">
        <input id="c_from" placeholder="예: GS25 한강르네상스 반포2호">
        <div class="coords" style="margin-top:8px">
          <input id="from_lat" type="number" step="any" placeholder="위도 (예: 33.509768)" inputmode="decimal" min="-90" max="90">
          <input id="from_lng" type="number" step="any" placeholder="경도 (예: 126.511954)" inputmode="decimal" min="-180" max="180">
        </div>
      </div>
    </div>

    <!-- 도착 -->
    <div class="row">
      <label for="c_to">도착</label>
      <div class="field">
        <input id="c_to" placeholder="예: RSG 성수">
        <div class="coords" style="margin-top:8px">
          <input id="to_lat" type="number" step="any" placeholder="위도" inputmode="decimal" min="-90" max="90">
          <input id="to_lng" type="number" step="any" placeholder="경도" inputmode="decimal" min="-180" max="180">
        </div>
      </div>
    </div>

    <!-- 인원 (잔여/정원) -->
    <div class="row">
      <label>인원</label>
      <div class="field">
        <div class="coords">
          <input id="c_remaining" type="number" min="0" placeholder="잔여">
          <input id="c_capacity" type="number" min="1" placeholder="정원">
        </div>
      </div>
    </div>

    <!-- 배기량 -->
    <div class="row">
      <label for="c_cc">배기량</label>
      <div class="field">
        <select id="c_cc">
          <option value="">관계없음</option>
          <option>125cc 이하</option>
          <option>125~250</option>
          <option>250~400</option>
          <option>400~800</option>
          <option>800 이상</option>
        </select>
      </div>
    </div>

    <!-- 스타일/페이스 -->
    <div class="row">
      <label>스타일</label>
      <div class="field"><div id="styleToggles" class="toggles"></div></div>
    </div>
    <div class="row">
      <label>페이스</label>
      <div class="field"><div id="paceToggles" class="toggles"></div></div>
    </div>

    <!-- 메시지 (한 줄) -->
    <div class="row">
      <label for="c_msg">메시지</label>
      <div class="field">
        <input id="c_msg" maxlength="30" placeholder="30자 이내">
      </div>
    </div>

    <!-- 테마(라벨 없음 / 메시지 하단) -->
    <div class="row no-label">
      <div class="field">
        <div id="themeBar" class="themes"></div>
      </div>
    </div>

    <!-- 기능 버튼 -->
    <div class="btnbar">
      <button class="btn" id="btnDraft">드래프트 저장</button>
      <button class="btn primary" id="btnPublish">메인에 발행</button>
      <button class="btn" id="btnReset">새로 작성</button>
    </div>
  </section>

  <section class="panel" id="cardsPanel">
    <h3>발행된 라이딩 카드 목록</h3>
    <div id="cards" class="cards"></div>
  </section>
</main>

<nav class="btmnav" aria-label="하단 내비게이션">
  <div class="wrap">
    <a class="navitem active" href="rimo_crew.html" title="크루 생성">
      <div class="ico">🛠️</div><div>크루 생성</div>
    </a>
    <a class="navitem" href="rimo_joins.html" title="매칭 희망">
      <div class="ico">🤝</div><div>매칭 희망</div>
    </a>
    <a class="navitem" href="rimo_routes.html" title="루트 제안">
      <div class="ico">🗺️</div><div>루트 제안</div>
    </a>
    <a class="navitem" href="rimo_feedback.html" title="후기 모음">
      <div class="ico">📝</div><div>후기 모음</div>
    </a>
    <a class="navitem" href="rimo_data.html" title="자료 관리">
      <div class="ico">🗄️</div><div>자료 관리</div>
    </a>
  </div>
</nav>

<script>
/* ---------- 기본 설정 ---------- */
const MAIN_URL = "https://roowalix.github.io/RIMO-test/index.html";

/* ---------- 옵션 ---------- */
const STYLE_OPTS = ["Urban","Curve","Tour"];
const PACE_OPTS  = ["Easy","Balanced","Dynamic"];
const THEME_OPTS = [
  {key:'red',    label:'레드',   emoji:'🔴'},
  {key:'blue',   label:'블루',   emoji:'🔵'},
  {key:'yellow', label:'옐로',   emoji:'🟡'},
  {key:'green',  label:'그린',   emoji:'🟢'},
  {key:'purple', label:'퍼플',   emoji:'🟣'}
];

/* ---------- 유틸 ---------- */
const qs=(s,p=document)=>p.querySelector(s);
const qsa=(s,p=document)=>Array.from(p.querySelectorAll(s));
const save=(k,v)=>localStorage.setItem(k,JSON.stringify(v));
const load=(k,def)=>{try{return JSON.parse(localStorage.getItem(k)||JSON.stringify(def))}catch(e){return def}};

/* 토글 */
function makeToggle(label, active=false){
  const el=document.createElement('button');
  el.type='button';
  el.className='toggle'+(active?' active':'');
  el.dataset.val=label;
  el.textContent = label;
  el.addEventListener('click',()=> el.classList.toggle('active'));
  return el;
}
function renderToggles(containerId, options, selected=[]){
  const box=qs('#'+containerId); box.innerHTML='';
  options.forEach(opt=> box.appendChild(makeToggle(opt, selected.includes(opt))) );
}
function selectedToggles(containerId){
  return qsa('#'+containerId+' .toggle.active').map(el=>el.dataset.val);
}

/* 테마 버튼(네비 스타일) */
function renderThemes(selected='blue'){
  const bar = qs('#themeBar'); bar.innerHTML='';
  THEME_OPTS.forEach(opt=>{
    const btn=document.createElement('button');
    btn.type='button';
    btn.className='theme-btn'+(opt.key===selected?' active':'');
    btn.dataset.theme=opt.key;
    btn.innerHTML = `
      <span class="badge">${opt.emoji}</span>
      <span class="tx">${opt.label}</span>
    `;
    btn.addEventListener('click',()=>{
      qsa('.theme-btn', bar).forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
    });
    bar.appendChild(btn);
  });
}
function getSelectedTheme(){
  const cur = qs('#themeBar .theme-btn.active');
  return cur ? cur.dataset.theme : 'blue';
}

/* 날짜 포맷 */
function pad(n){return String(n).padStart(2,'0')}
function formatKDate(dt){return `${dt.getMonth()+1}월 ${dt.getDate()}일 ${pad(dt.getHours())}:${pad(dt.getMinutes())}`}
function toLocalDatetimeValue(d){
  const y=d.getFullYear(), m=pad(d.getMonth()+1), day=pad(d.getDate()), hh=pad(d.getHours()), mi=pad(d.getMinutes());
  return `${y}-${m}-${day}T${hh}:${mi}`;
}
function getDateFromInput(){
  const v = qs('#c_datetime').value;
  if(!v) return null;
  const [date,time] = v.split('T');
  if(!date||!time) return null;
  const [Y,M,D] = date.split('-').map(Number);
  const [h,m] = time.split(':').map(Number);
  return new Date(Y, M-1, D, h, m||0, 0);
}

/* ===== 좌표 자동 분리(붙여넣기/변경 시) ===== */
function extractCoords(text){
  if(!text) return null;
  text = String(text).trim();
  let m = text.match(/@(-?\\d+(?:\\.\\d+)?),\\s*(-?\\d+(?:\\.\\d+)?)/);
  if(!m) m = text.match(/[?&]q=(-?\\d+(?:\\.\\d+)?),\\s*(-?\\d+(?:\\.\\d+)?)/);
  if(!m){
    const nums = text.match(/-?\\d+(?:\\.\\d+)?/g);
    if(nums && nums.length>=2) m=[, nums[0], nums[1]];
  }
  if(!m) return null;
  let lat = parseFloat(m[1]), lng = parseFloat(m[2]);
  if(Math.abs(lat)>90 && Math.abs(lng)<=90){ const t=lat; lat=lng; lng=t; }
  if(Math.abs(lat)>90 || Math.abs(lng)>180) return null;
  return {lat, lng};
}
function attachAutoSplit(latId,lngId){
  const latEl = qs('#'+latId);
  const lngEl = qs('#'+lngId);
  const onPaste = (e)=>{
    const text = e.clipboardData?.getData('text');
    const c = extractCoords(text);
    if(c){ e.preventDefault(); latEl.value=c.lat; lngEl.value=c.lng; }
  };
  const onChange = (e)=>{
    const c = extractCoords(e.target.value);
    if(c){ latEl.value=c.lat; lngEl.value=c.lng; }
  };
  latEl.addEventListener('paste', onPaste);
  lngEl.addEventListener('paste', onPaste);
  latEl.addEventListener('change', onChange);
  lngEl.addEventListener('change', onChange);
}

/* 폼 수집 */
function getForm(){
  const dt = getDateFromInput() || new Date();
  return {
    title: qs('#c_title').value.trim(),
    datetime: dt.toISOString(),
    datetime_display: formatKDate(dt),
    from: qs('#c_from').value.trim(),
    to: qs('#c_to').value.trim(),
    from_lat: parseFloat(qs('#from_lat').value||''),
    from_lng: parseFloat(qs('#from_lng').value||''),
    to_lat: parseFloat(qs('#to_lat').value||''),
    to_lng: parseFloat(qs('#to_lng').value||''),
    cc: qs('#c_cc').value,
    styles: selectedToggles('styleToggles'),
    pace: selectedToggles('paceToggles'),
    message: qs('#c_msg').value.trim(),
    remaining: parseInt(qs('#c_remaining').value||'0',10), // 잔여
    capacity: parseInt(qs('#c_capacity').value||'0',10),   // 정원
    theme: getSelectedTheme()
  };
}

/* 유효성 */
function validate(form){
  const errs=[];
  if(!form.title) errs.push('제목을 입력하세요.');
  if(!qs('#c_datetime').value) errs.push('일시를 선택하세요.');
  if(!form.from) errs.push('출발을 입력하세요.');
  if(!form.to) errs.push('도착을 입력하세요.');
  if(!(form.capacity>0)) errs.push('정원은 1 이상이어야 합니다.');
  if(form.remaining<0) errs.push('잔여는 0 이상이어야 합니다.');
  if(form.remaining>form.capacity) errs.push('잔여가 정원보다 클 수 없습니다.');
  if(form.message.length>30) errs.push('메시지는 30자 이내입니다.');
  return errs;
}

/* 저장/발행/초기화 */
const DRAFT_KEY='rimo_create_draft_v4';
const PUBLIST_KEY='rimo_published_cards_v1';

function loadDraft(){
  const d=load(DRAFT_KEY,null);

  renderToggles('styleToggles', STYLE_OPTS, d?.styles||[]);
  renderToggles('paceToggles',  PACE_OPTS,  d?.pace||[]);

  const now = new Date();
  const dt = d?.datetime ? new Date(d.datetime) : now;
  qs('#c_datetime').value = toLocalDatetimeValue(dt);

  // 테마: 저장값 있으면 복원, 없으면 blue
  renderThemes(d?.theme || 'blue');

  if(!d) return;
  qs('#c_title').value=d.title||'';
  qs('#c_from').value=d.from||'';
  qs('#c_to').value=d.to||'';
  qs('#from_lat').value=d.from_lat??'';
  qs('#from_lng').value=d.from_lng??'';
  qs('#to_lat').value=d.to_lat??'';
  qs('#to_lng').value=d.to_lng??'';
  qs('#c_cc').value=d.cc||'';
  qs('#c_msg').value=d.message||'';
  qs('#c_remaining').value = (d.remaining ?? d.capacity_min ?? '');
  qs('#c_capacity').value  = d.capacity ?? '';
}
function saveDraft(){
  const form=getForm();
  save(DRAFT_KEY, form);
  alert('드래프트 저장 완료');
}
function publish(){
  const form=getForm();
  const errs=validate(form);
  if(errs.length){ alert(errs.join('\\n')); return; }
  form.id = `crew_${Date.now().toString(36)}`;
  const list = load(PUBLIST_KEY,[]);
  list.unshift(form);
  save(PUBLIST_KEY,list);
  save(DRAFT_KEY, form);
  renderCards();
  // 발행 후 목록으로 스크롤
  document.querySelector('#cardsPanel')?.scrollIntoView({ behavior:'smooth', block:'start' });
  alert('메인에 임시 발행(로컬)되었습니다.');
}
function resetForm(){
  localStorage.removeItem(DRAFT_KEY);
  location.reload();
}

/* 카드 렌더 */
function renderCards(){
  const box=qs('#cards'); box.innerHTML='';
  const list = load(PUBLIST_KEY,[]);
  if(list.length===0){ box.innerHTML='<div class="hint">아직 발행된 카드가 없습니다.</div>'; return; }
  list.forEach(it=>{
    const theme = it.theme || 'blue';
    const remaining = (it.remaining ?? it.capacity_min ?? '-');
    const capacity  = (it.capacity ?? '-');

    const el=document.createElement('div');
    el.className='card';
    el.dataset.theme = theme;
    const themeLabel = ({red:'레드 크루',blue:'블루 크루',yellow:'옐로 크루',green:'그린 크루',purple:'퍼플 크루'})[theme] || '블루 크루';

    el.innerHTML = `
      <div class="tt">
        <span class="theme-tag">${themeLabel}</span>
        ${it.title||'(제목 없음)'} <span class="sub">· ${it.datetime_display||''}</span>
      </div>
      <div class="route">
        <span class="pin"></span><span class="place">${it.from||'-'}</span>
        <span class="dash"></span>
        <span class="pin"></span><span class="place">${it.to||'-'}</span>
      </div>
      <div class="sub">좌표: (${it.from_lat??'-'}, ${it.from_lng??'-'}) → (${it.to_lat??'-'}, ${it.to_lng??'-'})</div>
      <div class="sub">배기량: ${(it.cc && it.cc.trim()) ? it.cc : '관계없음'} · 인원: 잔여 ${remaining} / 정원 ${capacity}</div>
      <div class="sub">스타일: ${(it.styles||[]).join(', ')||'-'} · 페이스: ${(it.pace||[]).join(', ')||'-'}</div>
      <div class="sub">메시지: ${it.message||'-'}</div>
    `;
    box.appendChild(el);
  });
}

/* 초기화 */
(function init(){
  renderToggles('styleToggles', STYLE_OPTS, []);
  renderToggles('paceToggles',  PACE_OPTS,  []);
  document.querySelector('#c_datetime').value = toLocalDatetimeValue(new Date());

  /* 좌표 자동 분리 연결 */
  attachAutoSplit('from_lat','from_lng');
  attachAutoSplit('to_lat','to_lng');

  renderThemes('blue');  // 기본 테마
  loadDraft();
  renderCards();

  document.querySelector('#goMain')?.addEventListener('click',(e)=>{
    if(!MAIN_URL || MAIN_URL==="#"){ e.preventDefault(); alert("MAIN_URL을 메인주소로 설정하세요."); return; }
    window.open(MAIN_URL,'_blank');
  });
})();
</script>
</body>
</html>
