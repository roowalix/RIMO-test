<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RIMO — 라이더 카드</title>
<style>
  :root{
    --bg:#0b0b0f; --ink:#f1f3ff; --muted:#b6b8cc; --line:#23243a;
    --tile:#141627; --accent:#7aa7ff; --chip:#1a1c2f; --chipOn:#242743;
    --label-width:40px;
    /* tabbar */
    --tab-bg:#182039; --tab-bd:#2d3559; --tab-ink:#e6e8ef;
    --tab-pri:#26346d; --tab-pri-bd:#3b53a8;
  }

  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);
    font-family:-apple-system,BlinkMacSystemFont,"Noto Sans KR",Roboto,Helvetica,Arial,sans-serif;}

  /* 헤더 (공통) */
  header{position:sticky;top:0;z-index:5;background:rgba(11,11,15,.9);
         backdrop-filter:blur(8px);border-bottom:1px solid #232333}
  .bar{display:flex;gap:10px;align-items:center;padding:14px 16px;height:56px}
  .logo{font-weight:900}
  .title{font-weight:800;opacity:.9}

  main{
    padding:16px;max-width:520px;margin:0 auto;
    display:flex;flex-direction:column;gap:12px;
    padding-bottom:100px;
  }

  /* 작성 패널 */
  .panel{background:var(--tile);padding:12px;border-radius:14px;border:1px solid var(--line);
         display:flex;flex-direction:column;gap:10px}
  .form-row{display:flex;align-items:center;gap:10px;margin-left:6px}
  .form-row.top{align-items:flex-start}
  .form-row label{width:var(--label-width);font-size:14px;font-weight:700;white-space:nowrap}
  .field{flex:0.95}
  input[type="text"],select,textarea{
    width:100%;padding:8px 12px; border-radius:8px;border:1px solid #2c2f48;
    background:#0f1020;color:#fff;font-size:14px;
  }
  textarea{resize:none;height:40px}

  /* 토글(필) */
  .toggles{display:flex;gap:4px;flex-wrap:wrap;margin:4px 0}
  .toggle{
    display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;
    border:1px solid #2b2e54;background:#1a1c2f;color:#e6e9ff;font-size:12px;cursor:pointer;
    user-select:none;white-space:nowrap;transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease, background-color .15s ease, color .15s ease;
  }
  .toggle[role="button"]{outline:none}
  .toggle:focus-visible{
    outline:1px solid var(--accent);
    outline-offset:2px;
  }
  .toggle.active{
    border-color:var(--accent);
    border-width:1px;
    background:rgba(122,167,255,.16);
    color:#ffffff;
    box-shadow:0 0 10px rgba(122,167,255,.55), 0 0 0 1px rgba(122,167,255,.25) inset;
    transform:translateY(-1px) scale(1.03);
    font-weight:500;
  }
  .style-pill.pill-urban{border-color:#2c4484}
  .style-pill.pill-curve{border-color:#40307a}
  .style-pill.pill-tour{border-color:#2f5f5d}
  .pace-pill.pill-easy{border-color:#2f5a2f}
  .pace-pill.pill-balanced{border-color:#5a4f2f}
  .pace-pill.pill-dynamic{border-color:#5a2f2f}

  /* 아이콘 (5×2) + 소개 폭 동일 */
  .profile-icons{display:flex;flex-direction:column;align-items:center;gap:10px;margin:0px 0 0}
  .icons{display:grid;grid-template-columns:repeat(5,48px);grid-auto-rows:48px;gap:10px;justify-content:center}
  .icon-btn{
    width:50px;height:50px;border-radius:50%;
    display:flex;align-items:center;justify-content:center;
    font-size:28px;cursor:pointer;background:#1a1c2f;border:1px solid #2c2f48;transition:.15s ease;color:#fff;
    outline:none;
  }
  .icon-btn:focus-visible{
    outline:2px solid var(--accent);
    outline-offset:2px;
  }
  .icon-btn.active{
    border-color:var(--accent);
    box-shadow:0 0 12px rgba(122,167,255,.55), 0 0 0 2px rgba(122,167,255,.25) inset;
    transform:scale(1.06);
  }

  .intro-box{width:calc(48px*5 + 10px*4);margin:8px 0 0}
  #intro{width:100%;text-align:center;font-size:13px}

  /* 저장 버튼 */
  .save-btn{width:100%;padding:14px;margin-top:10px;font-size:15px;font-weight:700;background:#2a5bff;border:none;color:#fff;border-radius:10px;cursor:pointer}

  /* 하단 네비 (공통) */
  .tabbar{position:fixed;left:0;right:0;bottom:16px;z-index:2500;display:flex;gap:12px;justify-content:center}
  .tabbar .tab{background:var(--tab-bg);border:1px solid var(--tab-bd);color:var(--tab-ink);
    padding:12px 18px;border-radius:22px;font-weight:800;text-decoration:none;font-size:14px}
  .tabbar .tab.primary{background:var(--tab-pri);border-color:var(--tab-pri-bd)}

  /* 저장 후 미리보기 팝업 */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.5);z-index:3000;padding:16px}
  .modal.show{display:flex}
  .modal-content{width:100%;max-width:520px;background:#101223;border:1px solid var(--line);border-radius:16px;
    box-shadow:0 8px 24px rgba(0,0,0,.4);padding:18px 16px;display:flex;flex-direction:column;gap:12px}
  .card-head{display:flex;gap:14px;align-items:center}
  .avatar{width:72px;height:72px;border-radius:50%;background:#1a1c2f;font-size:36px;display:flex;align-items:center;justify-content:center;flex:0 0 auto}
  .idcol{min-width:0}
  .name{margin:0 0 4px;font-size:18px;font-weight:800}
  .sub{margin:0;color:var(--muted);font-size:13px}
  .grid-2{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
  .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
  .tag{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:8px 10px;border-radius:999px;background:#1a1c2f;border:1px solid #2b2e54;font-size:12px;white-space:nowrap}
  .tag.style.pill-urban{background:#1e2d55;border-color:#2c4484}
  .tag.style.pill-curve{background:#2a1f56;border-color:#40307a}
  .tag.style.pill-tour{background:#1e3b3a;border-color:#2f5f5d}
  .tag.pace.pill-easy{background:#1f3a1f;border-color:#2f5a2f}
  .tag.pace.pill-balanced{background:#3a341e;border-color:#5a4f2f}
  .tag.pace.pill-dynamic{background:#3a1f1f;border-color:#5a2f2f}
  .modal-actions{display:flex;gap:12px;justify-content:center;margin-top:6px}
  .modal-actions button{flex:1;padding:12px;border-radius:10px;border:none;font-size:14px;font-weight:800;cursor:pointer;color:#fff}
  .modal-actions .ok{background:#2a5bff}
  .modal-actions .edit{background:#2c2f48}
</style>
</head>
<body>
<header>
  <div class="bar">
    <div class="logo">🏍️ RIMO</div>
    <div class="title">프로필 작성</div>
  </div>
</header>

<main>
  <section class="panel">
    <div class="form-row">
      <label>라이더</label>
      <div class="field"><input id="handle" type="text" placeholder="예: RIMO rider"></div>
    </div>

    <!-- 기종 -->
    <div class="form-row">
      <label>기종</label>
      <div class="field"><input id="bike" type="text" placeholder="예: Honda MSX125"></div>
    </div>

    <!-- 지역 -->
    <div class="form-row">
      <label>지역</label>
      <div class="field">
        <select id="region">
          <option value="">지역 선택</option>
          <option>서울 강남구</option><option>서울 강동구</option><option>서울 강북구</option><option>서울 강서구</option>
          <option>서울 관악구</option><option>서울 광진구</option><option>서울 구로구</option><option>서울 금천구</option>
          <option>서울 노원구</option><option>서울 도봉구</option><option>서울 동대문구</option><option>서울 동작구</option>
          <option>서울 마포구</option><option>서울 서대문구</option><option>서울 서초구</option><option>서울 성동구</option>
          <option>서울 성북구</option><option>서울 송파구</option><option>서울 양천구</option><option>서울 영등포구</option>
          <option>서울 용산구</option><option>서울 은평구</option><option>서울 종로구</option><option>서울 중구</option>
          <option>서울 중랑구</option>
        </select>
      </div>
    </div>

    <div class="form-row">
      <label>시간대</label>
      <div class="field">
        <select id="time">
          <option value="05:00–10:00 (아침)">05:00–10:00 (아침)</option>
          <option value="14:00–17:00 (오후)">14:00–17:00 (오후)</option>
          <option value="18:00–22:00 (저녁)">18:00–22:00 (저녁)</option>
          <option value="23:00–03:00 (심야)">23:00–03:00 (심야)</option>
        </select>
      </div>
    </div>

    <div class="form-row">
      <label>탠덤</label>
      <div class="field">
        <select id="tandem">
          <option value="허용">허용</option>
          <option value="불가">불가</option>
        </select>
      </div>
    </div>

    <div class="form-row">
      <label>스타일</label>
      <div class="toggles" data-group="style">
        <span class="toggle style-pill pill-urban" role="button" tabindex="0" aria-pressed="false" data-value="Urban">🏙️ Urban</span>
        <span class="toggle style-pill pill-curve" role="button" tabindex="0" aria-pressed="false" data-value="Curve">🌀 Curve</span>
        <span class="toggle style-pill pill-tour" role="button" tabindex="0" aria-pressed="false" data-value="Tour">🗺️ Tour</span>
      </div>
    </div>

    <div class="form-row">
      <label>페이스</label>
      <div class="toggles" data-group="speed">
        <span class="toggle pace-pill pill-easy" role="button" tabindex="0" aria-pressed="false" data-value="Easy">🟢 Easy</span>
        <span class="toggle pace-pill pill-balanced" role="button" tabindex="0" aria-pressed="false" data-value="Balanced">⚖️ Balanced</span>
        <span class="toggle pace-pill pill-dynamic" role="button" tabindex="0" aria-pressed="false" data-value="Dynamic">⚡ Dynamic</span>
      </div>
    </div>

    <!-- 아이콘 + 소개 -->
    <div class="profile-icons">
      <div class="icons" id="iconSelect">
        <button type="button" class="icon-btn" aria-pressed="false" data-icon="🏍️">🏍️</button>
        <button type="button" class="icon-btn" aria-pressed="false" data-icon="🛵">🛵</button>
        <button type="button" class="icon-btn" aria-pressed="false" data-icon="🔥">🔥</button>
        <button type="button" class="icon-btn" aria-pressed="false" data-icon="🌊">🌊</button>
        <button type="button" class="icon-btn" aria-pressed="false" data-icon="☕">☕</button>
        <button type="button" class="icon-btn" aria-pressed="false" data-icon="⭐">⭐</button>
        <button type="button" class="icon-btn" aria-pressed="false" data-icon="🏁">🏁</button>
        <button type="button" class="icon-btn" aria-pressed="false" data-icon="🐶">🐶</button>
        <button type="button" class="icon-btn" aria-pressed="false" data-icon="⚡">⚡</button>
        <button type="button" class="icon-btn" aria-pressed="false" data-icon="🎱">🎱</button>
      </div>
      <div class="intro-box">
        <textarea id="intro" maxlength="25" placeholder="간단한 자기소개 (25자 이내)"></textarea>
      </div>
    </div>

    <button class="save-btn" id="saveBtn">프로필 저장</button>
  </section>
</main>

<!-- 하단 네비 -->
<nav class="tabbar" aria-label="하단 네비게이션">
  <a href="index.html" class="tab">메인</a>
  <a href="rimo_profile.html" class="tab primary">프로필</a>
  <a href="rimo_ambassadors.html" class="tab">엠버서더</a>
</nav>

<!-- 저장 후 미리보기 팝업 -->
<div class="modal" id="previewModal">
  <div class="modal-content">
    <div class="card-head">
      <div class="avatar" id="avatarPreview">🏍️</div>
      <div class="idcol">
        <h3 class="name" id="namePreview">라이더 이름</h3>
        <p class="sub" id="bikePreview">바이크 미입력 · 서울 지역</p>
      </div>
    </div>

    <div class="grid-2">
      <div class="tag" id="timePreview">18:00–22:00 (저녁)</div>
      <div class="tag" id="tandemPreview">탠덤 허용</div>
    </div>

    <div class="grid-3" id="styleGrid"></div>
    <div class="grid-3" id="paceGrid"></div>

    <div class="modal-actions">
      <button class="ok" id="confirmBtn">확인</button>
      <button class="edit" id="editBtn">수정</button>
    </div>
  </div>
</div>

<script>
const LS_KEY='rimo_profile_v1';

/* 아이콘 선택 */
let selectedIcon="🏍️";
const iconWrap=document.getElementById("iconSelect");
function updateIconActive(){
  iconWrap.querySelectorAll(".icon-btn").forEach(b => {
    const on = (b.dataset.icon === selectedIcon);
    b.classList.toggle("active", on);
    b.setAttribute('aria-pressed', on ? 'true' : 'false');
  });
}

/* 저장 공통 */
function collectProfile(){
  const styles=[...document.querySelectorAll('.toggles[data-group="style"] .toggle.active')].map(el=>el.dataset.value);
  const pace=[...document.querySelectorAll('.toggles[data-group="speed"] .toggle.active')].map(el=>el.dataset.value);
  return {
    name:document.getElementById('handle').value||'라이더 이름',
    bike:document.getElementById('bike').value||'바이크 미입력',
    region:document.getElementById('region').value||'',
    styles, pace,
    time:document.getElementById('time').value,
    tandem:document.getElementById('tandem').value,
    icon:selectedIcon,
    intro:document.getElementById('intro').value||''
  };
}
function saveProfile(){
  const p=collectProfile();
  localStorage.setItem(LS_KEY, JSON.stringify(p));
  return p;
}
function loadProfile(){
  try{ return JSON.parse(localStorage.getItem(LS_KEY)||'{}'); }
  catch(e){ return {}; }
}

/* 미리보기 렌더 */
function showPreview(p){
  document.getElementById('avatarPreview').textContent = p.icon || '🏍️';
  document.getElementById('namePreview').textContent = p.name || '라이더 이름';
  const sub = `${p.region? p.region+' · ' : ''}${p.bike||'바이크 미입력'}`;
  document.getElementById('bikePreview').textContent = sub;
  document.getElementById('timePreview').textContent = p.time || '-';
  document.getElementById('tandemPreview').textContent = `탠덤 ${p.tandem||'-'}`;

  const STYLE_META = {
    Urban:{emoji:'🏙️',cls:'pill-urban'},
    Curve:{emoji:'🌀',cls:'pill-curve'},
    Tour:{emoji:'🗺️',cls:'pill-tour'}
  };
  const PACE_META = {
    Easy:{emoji:'🟢',cls:'pill-easy'},
    Balanced:{emoji:'⚖️',cls:'pill-balanced'},
    Dynamic:{emoji:'⚡',cls:'pill-dynamic'}
  };

  const styleGrid = document.getElementById('styleGrid');
  styleGrid.innerHTML = (p.styles?.length?p.styles:['-']).map(s=>{
    const m=STYLE_META[s]; if(!m) return `<div class="tag style">${s}</div>`;
    return `<div class="tag style ${m.cls}">${m.emoji} ${s}</div>`;
  }).join('');

  const paceGrid = document.getElementById('paceGrid');
  paceGrid.innerHTML = (p.pace?.length?p.pace:['-']).map(s=>{
    const m=PACE_META[s]; if(!m) return `<div class="tag pace">${s}</div>`;
    return `<div class="tag pace ${m.cls}">${m.emoji} ${s}</div>`;
  }).join('');

  document.getElementById('previewModal').classList.add('show');
}

/* ===== 이벤트 바인딩 ===== */

/* 토글(필) 클릭/키보드 */
document.querySelectorAll('.toggles').forEach(group=>{
  group.addEventListener('click', e=>{
    const t=e.target.closest('.toggle'); if(!t) return;
    t.classList.toggle('active');
    t.setAttribute('aria-pressed', t.classList.contains('active') ? 'true' : 'false');
    saveProfile();
  });

  // 키보드 스페이스/엔터 활성화
  group.addEventListener('keydown', e=>{
    const t=e.target.closest('.toggle'); if(!t) return;
    if(e.key === ' ' || e.key === 'Enter'){
      e.preventDefault();
      t.click();
    }
  });
});

/* 아이콘 클릭/키보드 */
iconWrap.addEventListener("click", e=>{
  const btn=e.target.closest(".icon-btn"); if(!btn) return;
  selectedIcon=btn.dataset.icon;
  updateIconActive(); 
  saveProfile();
});
iconWrap.addEventListener("keydown", e=>{
  const btn=e.target.closest(".icon-btn"); if(!btn) return;
  if(e.key===' '||e.key==='Enter'){ e.preventDefault(); btn.click(); }
});

/* 입력 변경 저장 */
['handle','bike','region','time','tandem','intro'].forEach(id=>{
  const el=document.getElementById(id);
  el.addEventListener('input', saveProfile);
  el.addEventListener('change', saveProfile);
});

/* 저장 → 미리보기 */
document.getElementById('saveBtn').addEventListener('click',()=>{
  const p=saveProfile(); showPreview(p);
});
document.getElementById('confirmBtn').addEventListener('click',()=>{
  document.getElementById('previewModal').classList.remove('show');
});
document.getElementById('editBtn').addEventListener('click',()=>{
  document.getElementById('previewModal').classList.remove('show');
});
document.getElementById('previewModal').addEventListener('click',(e)=>{
  if(e.target.id==='previewModal'){ e.currentTarget.classList.remove('show'); }
});

/* 초기 로드 → 값/상태 복원 */
(function init(){
  const p=loadProfile();
  if(p.name) document.getElementById('handle').value=p.name;
  if(p.bike) document.getElementById('bike').value=p.bike;
  if(p.region) document.getElementById('region').value=p.region;
  if(p.time) document.getElementById('time').value=p.time;
  if(p.tandem) document.getElementById('tandem').value=p.tandem;
  if(p.intro) document.getElementById('intro').value=p.intro;

  if(Array.isArray(p.styles)){
    p.styles.forEach(v=>{
      const el=[...document.querySelectorAll('.toggles[data-group="style"] .toggle')].find(x=>x.dataset.value===v);
      if(el){ el.classList.add('active'); el.setAttribute('aria-pressed','true'); }
    });
  }
  if(Array.isArray(p.pace)){
    p.pace.forEach(v=>{
      const el=[...document.querySelectorAll('.toggles[data-group="speed"] .toggle')].find(x=>x.dataset.value===v);
      if(el){ el.classList.add('active'); el.setAttribute('aria-pressed','true'); }
    });
  }
  if(p.icon){ selectedIcon=p.icon; }
  updateIconActive();
})();
</script>
</body>
</html>
